<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><title>Chapter 7. Advices</title><link rel="stylesheet" href="docbook.css" type="text/css"></link><meta name="generator" content="DocBook XSL Stylesheets V1.71.0"></meta><link rel="start" href="index.html" title="phpAspect documentation"></link><link rel="up" href="index.html" title="phpAspect documentation"></link><link rel="prev" href="pointcuts.html" title="Chapter 6. Poincuts"></link><link rel="next" href="intertype-declarations.html" title="Chapter 8. Inter-type declarations"></link><script xmlns="" src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script><script xmlns="" type="text/javascript">
    _uacct = "UA-259974-1";
    urchinTracker();
    </script></head><body><a xmlns="" href="http://phpaspect.org"><img src="http://phpaspect.org/images/phpaspect.png" alt="phpAspect Logo" style="border:0;"></a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 7. Advices</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="pointcuts.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="intertype-declarations.html">Next</a></td></tr></table><hr></hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="advices"></a>Chapter 7. Advices</h2></div></div></div><p>
    Advices define the code to apply on pointcuts.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="advices.before"></a>Before advice</h2></div></div></div><p>Before advice executes prior to the join point:</p><div class="example"><a id="before-advice"></a><p class="title"><b>Example 7.1: Before advice.</b></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">before</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span><span class="default">&nbsp;</span><span class="default">call</span><span class="keyword">(</span><span class="default">HelloWorld</span><span class="keyword">::</span><span class="default">say</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">{</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">echo</span><span class="default">&nbsp;</span><span class="string">&quot;Before&nbsp;saying&nbsp;Hello&nbsp;World\n&quot;</span><span class="keyword">;</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break"></br></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="advices.after"></a>After advice</h2></div></div></div><p>After advice executes following to the join point:</p><div class="example"><a id="after-advice"></a><p class="title"><b>Example 7.2: After advice.</b></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">after</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span><span class="default">&nbsp;</span><span class="default">call</span><span class="keyword">(</span><span class="default">HelloWorld</span><span class="keyword">::</span><span class="default">say</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">{</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">echo</span><span class="default">&nbsp;</span><span class="string">&quot;After&nbsp;saying&nbsp;Hello&nbsp;World\n&quot;</span><span class="keyword">;</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break"></br></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="advices.around"></a>Around advice</h2></div></div></div><p>
            Around advice replace the joinppoint execution.
            In an around advice, the <code class="literal">proceed()</code> call function
            represents the joinpoint execution.
        </p><div class="example"><a id="around-advice"></a><p class="title"><b>Example 7.3: Around advice.</b></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">around</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span><span class="default">&nbsp;</span><span class="default">call</span><span class="keyword">(</span><span class="default">HelloWorld</span><span class="keyword">::</span><span class="default">say</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">{</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">echo</span><span class="default">&nbsp;</span><span class="string">&quot;50%&nbsp;chance&nbsp;to&nbsp;say&nbsp;Hello&nbsp;World\n&quot;</span><span class="keyword">;</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span class="keyword">(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">{</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="default">proceed</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">}</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break"></br><p>
        The return statement can be used in an around advice.
        The returned expression will replace the joinpoint execution.
        </p><div class="example"><a id="return-around-advice"></a><p class="title"><b>Example 7.4: Return statement in an around advice.</b></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">around</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">:</span><span class="default">&nbsp;</span><span class="default">exec</span><span class="keyword">(</span><span class="default">Cart</span><span class="keyword">::</span><span class="default">getAmount</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">{</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//Give&nbsp;a&nbsp;20%&nbsp;discount</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="default">$amount</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">proceed</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$amount</span><span class="keyword">-</span><span class="default">0.2</span><span class="keyword">*</span><span class="default">$amount</span><span class="keyword">;</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break"></br></div></div><div class="navfooter"><hr></hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="pointcuts.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="intertype-declarations.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 6. Poincuts </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 8. Inter-type declarations</td></tr></table></div><div xmlns="" class="copyright-notice"><a href="appendixes.copyright.html">Copyright</a> © 2006-2007 <a href="mailto:wcandillon@elv.telecom-lille1.eu">William Candillon</a>
      and <a href="mailto:vanwormhoudt@telecom-lille1.eu">Gilles Vanwormhoudt</a>.
    </div></body></html>
